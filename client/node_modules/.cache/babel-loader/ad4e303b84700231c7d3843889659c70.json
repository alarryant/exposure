{"ast":null,"code":"import _classCallCheck from \"/vagrant/week8/exposure/exposure-final/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/vagrant/week8/exposure/exposure-final/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/vagrant/week8/exposure/exposure-final/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/vagrant/week8/exposure/exposure-final/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/vagrant/week8/exposure/exposure-final/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/vagrant/week8/exposure/exposure-final/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/vagrant/week8/exposure/exposure-final/src/Opportunities.jsx\";\nimport React, { Component } from 'react';\nimport \"react-tabs/style/react-tabs.css\";\nimport axios from 'axios';\nimport OpportunityEventCard from './components/Opportunity_EventCard.jsx';\nimport AppliedCard from './Opportunities_Applied.jsx';\nimport './styles/Opportunities.css';\nimport CreateEvent from './CreateEvent';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport MyEvent from './components/Opportunity_MyEvents.jsx'; //MAIN OPPORTUNITIES BOARD\n\nvar Opportunities =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Opportunities, _Component);\n\n  function Opportunities(props) {\n    var _this;\n\n    _classCallCheck(this, Opportunities);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Opportunities).call(this, props));\n    _this.state = {\n      opportunities: '',\n      applicationsent: false,\n      appliedopportunities: []\n    };\n    _this.displayEvents = _this.displayEvents.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.saveInterestedApplicants = _this.saveInterestedApplicants.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.createEvent = _this.createEvent.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showSuccessMsg = _this.showSuccessMsg.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.deleteEvent = _this.deleteEvent.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.refreshApplybutton = _this.refreshApplybutton.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Opportunities, [{\n    key: \"showSuccessMsg\",\n    value: function showSuccessMsg() {\n      return React.createElement(\"div\", {\n        className: \"applicationSent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      }, \"Your application has been sent! Thanks for applying!\"));\n    } //CLIENT: DELETE EVENT IF YOU ARE THE CREATOR OF THE EVENT\n\n  }, {\n    key: \"deleteEvent\",\n    value: function deleteEvent(event, creator) {\n      var _this2 = this;\n\n      var currentUser = parseInt(this.props.currentUser);\n\n      if (creator === currentUser) {\n        axios.post(\"/opportunities/\".concat(event, \"/delete\"), {\n          event_id: event,\n          creatorid: creator\n        }).then(function (res) {\n          var newEvents = res.data;\n\n          _this2.setState({\n            opportunities: newEvents\n          });\n        });\n        axios.get(\"/api/opportunities/applied/\".concat(this.props.currentUser)).then(function (res) {\n          _this2.setState({\n            'appliedopportunities': res.data\n          });\n        });\n      }\n    } //PHOTOGRAPHER: SAVES THEIR APPLICATION\n\n  }, {\n    key: \"saveInterestedApplicants\",\n    value: function saveInterestedApplicants(event, artist, desc) {\n      var _this3 = this;\n\n      this.setState({\n        applicationsent: true\n      });\n      var event_id = event;\n      var description = desc;\n      var artist_name = this.props.currentUserName;\n      axios.post(\"/opportunities/\".concat(event_id, \"/apply\"), {\n        event_id: event_id,\n        artist_id: artist,\n        msg_des: description,\n        artist_name: artist_name\n      }).then(function (data) {\n        axios.get(\"/api/opportunities/applied/\".concat(_this3.props.currentUser)).then(function (res) {\n          var appliedevent = res.data;\n          var applied_eventid = [];\n          appliedevent.forEach(function (i) {\n            applied_eventid.push(i.eventref_id);\n          });\n\n          _this3.setState({\n            'appliedopportunities': applied_eventid\n          });\n        });\n      });\n    } //PHOTOGRAPHER: IF DELETE APPLICATION, BUTTON REAPPEARS ON JOB BOARD\n\n  }, {\n    key: \"refreshApplybutton\",\n    value: function refreshApplybutton() {\n      var _this4 = this;\n\n      axios.get(\"/api/opportunities/applied/\".concat(this.props.currentUser)).then(function (res) {\n        var appliedevent = res.data;\n        var applied_eventid = [];\n        appliedevent.forEach(function (i) {\n          applied_eventid.push(i.eventref_id);\n        });\n\n        _this4.setState({\n          appliedopportunities: applied_eventid,\n          applicationsent: false\n        });\n      });\n    } //DISPLAYS OPPORTUNITIES\n\n  }, {\n    key: \"displayEvents\",\n    value: function displayEvents(events) {\n      var _this5 = this;\n\n      if (!events || events.length === 0) {\n        return React.createElement(\"div\", {\n          className: \"emptyevent\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, React.createElement(\"h4\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, \"There are currently no postings!\"));\n      } else {\n        return events.map(function (event) {\n          var date = event.event_date.toString().split('T')[0];\n          if (!event.artist_accepted) return React.createElement(OpportunityEventCard, {\n            appliedEvents: _this5.state.appliedopportunities,\n            deleteEvent: _this5.deleteEvent,\n            saveApplication: _this5.saveInterestedApplicants,\n            event: event,\n            date: date,\n            usertype: _this5.props.usertype,\n            currentUser: _this5.props.currentUser,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          });\n        });\n      }\n    } //CLIENT: CAN CREATE EVENTS\n\n  }, {\n    key: \"createEvent\",\n    value: function createEvent(title, description, date, price, location) {\n      var _this6 = this;\n\n      axios.post(\"/opportunities/:id/add\", {\n        title: title,\n        description: description,\n        date: date,\n        price: price,\n        location: location,\n        creator_id: this.props.currentUser\n      }).then(function (res) {\n        var newEvents = res.data;\n\n        _this6.setState({\n          opportunities: newEvents\n        });\n      });\n    } //REMOVES APPLICATION SUCCESS SIGN\n\n  }, {\n    key: \"handleClick\",\n    value: function handleClick() {\n      this.setState({\n        applicationsent: false\n      });\n    } //ON MOUNT FIND\n\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this7 = this;\n\n      this.setState({\n        applicationsent: false\n      });\n      axios.get(\"/api/opportunities\").then(function (res) {\n        _this7.setState({\n          opportunities: res.data.reverse()\n        });\n      });\n      axios.get(\"/api/opportunities/applied/\".concat(this.props.currentUser)).then(function (res) {\n        var appliedevent = res.data;\n        var applied_eventid = [];\n        appliedevent.forEach(function (i) {\n          applied_eventid.push(i.eventref_id);\n        });\n\n        _this7.setState({\n          'appliedopportunities': applied_eventid\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var usertype = parseInt(this.props.usertype);\n      return React.createElement(Tabs, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(TabList, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(Tab, {\n        style: {\n          fontSize: '18px'\n        },\n        onClick: this.handleClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, \" Job Board \"), usertype === 1 ? React.createElement(Tab, {\n        style: {\n          fontSize: '16px'\n        },\n        onClick: this.handleClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, \" Applied Opportunities \") : React.createElement(Tab, {\n        style: {\n          fontSize: '16px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, \"My Events\")), React.createElement(TabPanel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"section\", {\n        className: \"opportunities\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, this.state.applicationsent ? this.showSuccessMsg() : \"\", React.createElement(\"div\", {\n        className: \"oppHeader\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, \"Opportunities Board\"), usertype === 2 ? React.createElement(CreateEvent, {\n        createEvent: this.createEvent,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }) : \"\"), this.displayEvents(this.state.opportunities))), React.createElement(TabPanel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, usertype === 1 ? React.createElement(AppliedCard, {\n        currentUser: this.props.currentUser,\n        usertype: this.props.usertype,\n        refreshApplybutton: this.refreshApplybutton,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }) : React.createElement(MyEvent, {\n        createEvent: this.createEvent,\n        displayEvents: this.displayEvents,\n        currentUser: this.props.currentUser,\n        usertype: this.props.usertype,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Opportunities;\n}(Component);\n\nexport default Opportunities;","map":{"version":3,"sources":["/vagrant/week8/exposure/exposure-final/src/Opportunities.jsx"],"names":["React","Component","axios","OpportunityEventCard","AppliedCard","CreateEvent","Tab","Tabs","TabList","TabPanel","MyEvent","Opportunities","props","state","opportunities","applicationsent","appliedopportunities","displayEvents","bind","saveInterestedApplicants","createEvent","showSuccessMsg","deleteEvent","refreshApplybutton","handleClick","event","creator","currentUser","parseInt","post","event_id","creatorid","then","res","newEvents","data","setState","get","artist","desc","description","artist_name","currentUserName","artist_id","msg_des","appliedevent","applied_eventid","forEach","i","push","eventref_id","events","length","map","date","event_date","toString","split","artist_accepted","usertype","title","price","location","creator_id","reverse","fontSize"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport \"react-tabs/style/react-tabs.css\";\nimport axios from 'axios';\nimport OpportunityEventCard from './components/Opportunity_EventCard.jsx';\nimport AppliedCard from './Opportunities_Applied.jsx';\nimport './styles/Opportunities.css';\nimport CreateEvent from './CreateEvent';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport MyEvent from './components/Opportunity_MyEvents.jsx'\n\n//MAIN OPPORTUNITIES BOARD\n\nclass Opportunities extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      opportunities: '',\n      applicationsent: false,\n      appliedopportunities: []\n    };\n\n    this.displayEvents = this.displayEvents.bind(this);\n    this.saveInterestedApplicants = this.saveInterestedApplicants.bind(this);\n    this.createEvent = this.createEvent.bind(this);\n    this.showSuccessMsg = this.showSuccessMsg.bind(this);\n    this.deleteEvent = this.deleteEvent.bind(this);\n    this.refreshApplybutton = this.refreshApplybutton.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  showSuccessMsg() {\n    return (\n      <div className=\"applicationSent\">\n        <h3>\n          Your application has been sent! Thanks for applying!\n        </h3>\n      </div>\n    )\n  }\n\n//CLIENT: DELETE EVENT IF YOU ARE THE CREATOR OF THE EVENT\n  deleteEvent(event, creator) {\n    let currentUser = parseInt(this.props.currentUser)\n\n    if (creator === currentUser) {\n      axios.post(`/opportunities/${event}/delete`, {\n          event_id: event,\n          creatorid: creator\n        })\n      .then((res) => {\n        let newEvents = res.data;\n        this.setState({ opportunities: newEvents });\n      })\n      axios.get(`/api/opportunities/applied/${this.props.currentUser}`)\n        .then(res => {\n          this.setState({'appliedopportunities': res.data })\n        });\n    }\n  }\n\n//PHOTOGRAPHER: SAVES THEIR APPLICATION\n  saveInterestedApplicants(event, artist, desc) {\n    this.setState({applicationsent: true});\n    let event_id = event\n    let description = desc\n    let artist_name = this.props.currentUserName\n    axios.post(`/opportunities/${event_id}/apply`,\n      { event_id: event_id,\n        artist_id: artist,\n        msg_des: description,\n        artist_name: artist_name})\n      .then((data) => {\n        axios.get(`/api/opportunities/applied/${this.props.currentUser}`)\n        .then(res => {\n          let appliedevent = res.data\n          let applied_eventid = []\n\n          appliedevent.forEach((i) => {\n            applied_eventid.push(i.eventref_id)\n          })\n\n        this.setState({'appliedopportunities': applied_eventid })\n      })\n    })\n  }\n\n//PHOTOGRAPHER: IF DELETE APPLICATION, BUTTON REAPPEARS ON JOB BOARD\n  refreshApplybutton() {\n    axios.get(`/api/opportunities/applied/${this.props.currentUser}`)\n        .then(res => {\n          let appliedevent = res.data\n          let applied_eventid = []\n\n          appliedevent.forEach((i) => {\n            applied_eventid.push(i.eventref_id)\n          })\n        this.setState({\n          appliedopportunities: applied_eventid,\n          applicationsent: false\n        })\n    })\n  }\n\n//DISPLAYS OPPORTUNITIES\n  displayEvents(events) {\n    if (!events || events.length === 0 ) {\n      return (\n        <div className=\"emptyevent\">\n        <h4>\n          There are currently no postings!\n        </h4>\n        </div>\n      )\n    } else {\n      return events.map((event) => {\n        let date = event.event_date.toString().split('T')[0]\n        if (!event.artist_accepted)\n        return (\n          <OpportunityEventCard\n              appliedEvents={this.state.appliedopportunities}\n              deleteEvent={this.deleteEvent}\n              saveApplication={this.saveInterestedApplicants}\n              event={event}\n              date={date}\n              usertype={this.props.usertype}\n              currentUser={this.props.currentUser}/>\n        )\n      })\n    }\n  }\n\n//CLIENT: CAN CREATE EVENTS\n  createEvent(title, description, date, price, location) {\n    axios.post(\"/opportunities/:id/add\",\n      { title: title,\n        description: description,\n        date: date,\n        price: price,\n        location: location,\n        creator_id: this.props.currentUser\n      })\n      .then((res) => {\n        let newEvents = res.data;\n        this.setState({ opportunities: newEvents });\n      });\n  }\n\n//REMOVES APPLICATION SUCCESS SIGN\n  handleClick() {\n    this.setState({applicationsent: false})\n  }\n\n//ON MOUNT FIND\n  componentDidMount() {\n    this.setState({applicationsent: false})\n    axios.get(\"/api/opportunities\")\n      .then(res => {\n        this.setState({ opportunities: res.data.reverse() })\n    });\n\n    axios.get(`/api/opportunities/applied/${this.props.currentUser}`)\n      .then(res => {\n        let appliedevent = res.data\n        let applied_eventid = []\n        appliedevent.forEach((i) => {\n          applied_eventid.push(i.eventref_id)\n        })\n      this.setState({'appliedopportunities': applied_eventid })\n    })\n  }\n\n  render() {\n    let usertype = parseInt(this.props.usertype);\n    return (\n\n      <Tabs>\n        <TabList>\n          <Tab style={{fontSize: '18px'}} onClick={this.handleClick}> Job Board </Tab>\n          {usertype === 1 ? <Tab style={{fontSize: '16px'}} onClick={this.handleClick}> Applied Opportunities </Tab> : <Tab style={{fontSize: '16px'}}>My Events</Tab>}\n        </TabList>\n\n        <TabPanel>\n          <section className=\"opportunities\">\n          {this.state.applicationsent ? this.showSuccessMsg() : \"\"}\n            <div className=\"oppHeader\">\n              <h2>Opportunities Board</h2>\n              {usertype === 2 ?\n                <CreateEvent createEvent={this.createEvent}/>\n                : \"\"\n              }\n            </div>\n              { this.displayEvents(this.state.opportunities) }\n          </section>\n        </TabPanel>\n\n        <TabPanel>\n          {usertype === 1 ?\n            <AppliedCard\n              currentUser={this.props.currentUser}\n              usertype={this.props.usertype}\n              refreshApplybutton={this.refreshApplybutton}\n              />\n          : <MyEvent\n              createEvent={this.createEvent}\n              displayEvents={this.displayEvents}\n              currentUser={this.props.currentUser}\n              usertype={this.props.usertype}\n              />\n          }\n        </TabPanel>\n      </Tabs>\n    );\n  }\n}\n\nexport default Opportunities;"]},"metadata":{},"sourceType":"module"}